const TOKEN={OR:10,CONCAT:20,CERRPOS:30,CERRKLEEN:40,CERROPC:50,LPAREN:60,SPACE:70,RPAREN:80,LCORCH:90,RCORCH:100,DASH:110,SIMB:120,END:0};class Nodo{constructor(e,s=[]){this.name=e,this.children=s}}class ExpresionRegular{constructor(e="",s=null){this.ER=e,this.AL=new AnalizadorLexico(e,s),this.result=null,this.tree=new Nodo("E")}getTree(){return this.tree}getResult(){return this.result}getER(){return this.ER}setER(e){this.ER=e,this.AL.setSigma(e)}parse(){const e=new AFN,s=[];if(this.E(e,s)){this.tree.children=s;return this.AL.yylex()===TOKEN.END&&(this.result=e,!0)}return!1}E(e,s){const t=[];if(this.T(e,t)){s.push(new Nodo("T",t));const n=[];if(this.Ep(e,n))return s.push(new Nodo("E'",n)),!0}return!1}Ep(e,s){if(this.AL.yylex()===TOKEN.OR){s.push(new Nodo("|"));const t=new AFN,n=[];if(this.T(t,n)){s.push(new Nodo("T",n));const o=[];if(this.Ep(t,o))return s.push(new Nodo("E'",o)),e.Unir(t),!0}return!1}return this.AL.undoToken(),!0}T(e,s){const t=[];if(this.C(e,t)){s.push(new Nodo("C",t));const n=[];if(this.Tp(e,n))return s.push(new Nodo("T'",n)),!0}return!1}Tp(e,s){if(this.AL.yylex()===TOKEN.CONCAT){s.push(new Nodo("&"));const t=new AFN,n=[];if(this.C(t,n)){s.push(new Nodo("C",n));const o=[];if(this.Tp(t,o))return s.push(new Nodo("T'",o)),e.Concatenar(t),!0}return!1}return this.AL.undoToken(),!0}C(e,s){const t=[];if(this.F(e,t)){s.push(new Nodo("F",t));const n=[];if(this.Cp(e,n))return s.push(new Nodo("C'",n)),!0}return!1}Cp(e,s){switch(this.AL.yylex()){case TOKEN.CERRPOS:return s.push(new Nodo("+")),!!this.Cp(e,[])&&(e.Cerradura_Positiva(),!0);case TOKEN.CERRKLEEN:return s.push(new Nodo("*")),!!this.Cp(e,[])&&(e.Cerradura_Kleene(),!0);case TOKEN.CERROPC:return s.push(new Nodo("?")),!!this.Cp(e,[])&&(e.Opcional(),!0);default:return this.AL.undoToken(),!0}}F(e,s){switch(this.AL.yylex()){case TOKEN.LPAREN:s.push(new Nodo("("));const t=[];if(this.E(e,t)){s.push(new Nodo("E",t));if(this.AL.yylex()===TOKEN.RPAREN)return s.push(new Nodo(")")),!0}return!1;case TOKEN.LCORCH:s.push(new Nodo("["));const n=this.AL.yylex();if(n===TOKEN.SIMB||n===TOKEN.SPACE){const t=this.AL.getLexema(),n="\\"===t[0]?t[1]:t[0];s.push(new Nodo(n));if(this.AL.yylex()===TOKEN.DASH){s.push(new Nodo("-"));const t=this.AL.yylex();if(t===TOKEN.SIMB||t===TOKEN.SPACE){const t=this.AL.getLexema(),o="\\"===t[0]?t[1]:t[0];s.push(new Nodo(o));if(this.AL.yylex()===TOKEN.RCORCH){s.push(new Nodo("]"));const t=AFN.Crear_Basico_AFN(n,o);return Object.assign(e,t),!0}}}}return!1;case TOKEN.SIMB:case TOKEN.SPACE:const o=this.AL.getLexema(),r="\\"===o[0]?o[1]:o[0];s.push(new Nodo(r));const i=AFN.Crear_Basico_AFN(r);return Object.assign(e,i),!0;default:return!1}}}