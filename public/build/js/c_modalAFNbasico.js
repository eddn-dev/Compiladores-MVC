function handleCrearAFNBasico(e){let a=null;function o(a){const o=e.querySelector(".automaton_preview");if(!a)return void t();const r=a.convertirACytoscape();cytoscape({container:o,elements:r,style:[{selector:"node",style:{label:"data(label)","text-valign":"center",color:"#fff","background-color":"#666",shape:"ellipse",width:"40px",height:"40px","font-size":"12px"}},{selector:"edge",style:{label:"data(label)","curve-style":"bezier","control-point-step-size":40,"target-arrow-shape":"triangle","arrow-scale":1.2,width:2,"line-color":"#9dbaea","target-arrow-color":"#9dbaea","font-size":"10px","text-background-color":"#fff","text-background-opacity":1,"text-background-padding":"2px","edge-text-rotation":"autorotate"}},{selector:"node.estadoAceptacion",style:{"background-color":"#f39c12",shape:"double-octagon"}},{selector:"node.estadoInicial",style:{"background-color":"#27ae60",shape:"star"}}],layout:{name:"breadthfirst",directed:!0,padding:10,roots:`#estado_${a.Edo_Inicial.Id_Edo}`}})}function t(){e.querySelector(".automaton_preview").innerHTML=""}handleAFNModal(e,{fields:[{name:"automatonId",selector:"#automaton-id",alertSelector:"#automaton-id-alert",validate:e=>e?/^[0-9]+$/.test(e)?AFNS.some((a=>a.ID_AFN===e))?"El ID ya existe. Elige otro.":null:"El ID solo puede contener números.":"El ID es obligatorio."},{name:"startSymbol",selector:"#start-symbol",alertSelector:"#start-symbol-alert",validate:e=>e?esCaracterValido(e)?null:"El símbolo de inicio debe ser un carácter válido.":"El símbolo de inicio es obligatorio."},{name:"endSymbol",selector:"#end-symbol",alertSelector:"#end-symbol-alert",validate:(e,a)=>{const o=a.startSymbol.value;if(e){if(!esCaracterValido(e))return"El símbolo de final debe ser un carácter válido o estar vacío.";if(o&&o>e)return"El símbolo final no puede ser menor que el símbolo inicial (valor ASCII)."}return null}}],onSubmit:(o,t)=>{const r=o.automatonId.value.trim(),l=o.startSymbol.value,s=o.endSymbol.value||null;a=AFN.Crear_Basico_AFN(l,s),a.ID_AFN=r;switch(t.querySelector('input[name="cerradura"]:checked').value){case"kleene":a.Cerradura_Kleene();break;case"epsilon":a.Cerradura_Positiva()}AFNS.push(a),actualizarSelectsDeAFN(),mostrarNotificacion("AFN básico creado exitosamente.","success"),closeModal(e)},successMessage:"AFN básico creado exitosamente.",errorMessage:"Por favor, corrige los errores antes de continuar."}),o(null);e.querySelectorAll('input[type="text"], input[name="cerradura"]').forEach((a=>{a.addEventListener("input",(()=>{const a=obtenerValoresDeCampos(e);if(a.automatonId.value&&a.startSymbol.value&&a.startSymbol.isValid&&a.endSymbol.isValid)try{Estado.Cant_Edos=0,AFN.Cant_AFN=0;let t=AFN.Crear_Basico_AFN(a.startSymbol.value,a.endSymbol.value||null);t.ID_AFN=a.automatonId.value.trim();switch(e.querySelector('input[name="cerradura"]:checked').value){case"kleene":t.Cerradura_Kleene();break;case"epsilon":t.Cerradura_Positiva()}o(t)}catch(e){console.error("Error al crear el AFN:",e),t()}else t()}))}))}function obtenerValoresDeCampos(e){const a={};return a.automatonId={value:e.querySelector("#automaton-id").value.trim(),isValid:!0},a.startSymbol={value:e.querySelector("#start-symbol").value,isValid:esCaracterValido(e.querySelector("#start-symbol").value)},a.endSymbol={value:e.querySelector("#end-symbol").value,isValid:""===e.querySelector("#end-symbol").value||esCaracterValido(e.querySelector("#end-symbol").value)},a}function esCaracterValido(e){return"string"==typeof e&&1===e.length}